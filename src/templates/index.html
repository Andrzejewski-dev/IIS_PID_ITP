<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>PID</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- <link rel='stylesheet' type='text/css' media='screen' href='main.css'> -->
</head>
<body>
    <div style="width: 800px;">
        <canvas id="myChart"></canvas>
    </div> 

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>


const data = {
    labels: [],
    datasets: [
        {
            label: 'Natężenie dopływu',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [],
        },
        {
            label: 'Wysokość w zbiorniku',
            backgroundColor: 'rgb(128, 255, 128)',
            borderColor: 'rgb(128, 255, 128)',
            data: []
        }
    ]
};

const config = {
    type: 'line',
    data: data,
    options: {
        pointRadius: 0,
        pointHitRadius: 0,
        pointBorderWidth: 0,
        tension: 0.3,
        fill: false,
        scales: {
            xAxes: [{
                ticks: {
                reverse: false,
                stepSize: 100
                },
            }]
        }
    }
};


const chart = new Chart(
    document.getElementById('myChart'),
    config
);

function updateData() {
    $.ajax({
        url: "/uar",
    }).done(function(data) {
        console.log(data);
        console.log(chart);
        chart.data.labels = data.n_axis;
        chart.data.datasets[0].data = data.Qd_axis;
        chart.data.datasets[1].data = data.h_axis;
        chart.update();
    });
}

$(() => {
    updateData();
});

    </script>
</body>
</html>
